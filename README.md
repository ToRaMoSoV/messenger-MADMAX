# Anon Decentral Messenger

Anon Decentral Messenger — децентрализованный одноранговый мессенджер на Python 3 с графическим интерфейсом PyQt6.  
Приложение использует современную криптографию для шифрования сообщений и не требует центральных серверов.

---

## Возможности

- P2P-взаимодействие без централизованных узлов  
- Автоматический обмен ключами X25519 (ECDH)  
- Симметричное шифрование ChaCha20 (256 бит)  
- Контроль целостности через SHA-256  
- Сессионные ключи, пересоздающиеся при каждом подключении  
- Локальная база SQLite с возможностью шифрования AES-256-CBC  
- Кроссплатформенность (Linux / Windows)

---

## Запуск

Исполняемый файл или shell-скрипт **madmax** не требует параметров:

```bash
chmod +x madmax
./madmax
```
Для ручного выбора графического бэкенда Qt:

QT_QPA_PLATFORM=xcb ./madmax       # X11
QT_QPA_PLATFORM=wayland ./madmax   # Wayland


---

Криптографическая основа

Обмен ключами (ECDH, X25519)

1. При подключении хост и клиент обмениваются открытыми ключами X25519.


2. Каждый вычисляет общий секрет с помощью алгоритма Диффи–Хеллмана.


3. Из секрета формируется симметричный ключ длиной 256 бит:

shared_key = SHA256(X25519.exchange(private_key, peer_public_key))



Симметричное шифрование

Алгоритм: ChaCha20

Ключ: 256 бит

Nonce: 128 бит, уникален для каждого пакета

Контроль целостности осуществляется через SHA-256:

digest = SHA256(nonce || ciphertext || SHA256(key))


При несовпадении digest пакет отвергается.

Локальное хранение

История чатов сохраняется в SQLite (chat.db)

Поддерживается шифрование базы AES-256-CBC с PKCS#7 паддингом

Ключ для шифрования базы — SHA-256 от пользовательского пароля



---

Логика работы

1. Пользователь запускает приложение и выбирает режим:

Host — создаёт комнату и слушает входящие подключения

Client — подключается к IP и порту хоста



2. После установления соединения выполняется обмен открытыми ключами X25519


3. Генерируется общий симметричный ключ ChaCha20


4. Все сообщения и файлы передаются в зашифрованном виде


5. Приёмник проверяет хеш SHA-256 и расшифровывает сообщение


6. Все события и сообщения сохраняются локально




---

Основные модули

Модуль	Назначение

socket_module/net.py	Сетевой слой, обмен ключами, ChaCha20-шифрование
ui/main_window.py	Графический интерфейс на PyQt6
db_module/orm.py	Работа с базой SQLite
db_module/edb.py	Шифрование / расшифровка базы данных
main.py	Точка входа в приложение



---

Безопасность

Ключи сеанса создаются заново при каждом подключении

ChaCha20 используется для потокового шифрования сообщений

X25519 обеспечивает безопасный обмен ключами без пароля

SHA-256 гарантирует проверку целостности данных

Нет серверов — трафик передаётся напрямую между участниками

Локальная изоляция — история сообщений хранится только на устройстве пользователя

Обфускация кода возможна при сборке с помощью PyArmor



---

Лицензия

Программа распространяется свободно и предоставляется «как есть»,
без гарантий. Разрешено использование в исследовательских и образовательных целях
